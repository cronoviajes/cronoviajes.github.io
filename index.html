<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cronoviajes ‚Äî Viaje al C√°mbrico</title>
  <meta name="description" content="Cronoviajes ‚Äî Simulaciones educativas y juegos para viajar al C√°mbrico.">
  <meta name="author" content="Cronoviajes S.A.">

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    /* =========================
       RESET & VARIABLES
       ========================= */
    :root{
      --bg:#f5fbff;
      --ocean-900:#001a2e;
      --ocean-700:#006b9f;
      --accent:#00b4d8;
      --muted:#5c7a89;
      --card:#ffffff;
      --glass: rgba(255,255,255,0.7);
      --radius:14px;
      --maxw:1200px;
      --gold:#ffd166;
      --success:#2a9d8f;
      --danger:#d62828;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,var(--bg), #e7f7ff);
      color:var(--ocean-900);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.5;
    }
    a{ color:inherit; text-decoration:none; }

    /* =========================
       HERO / HEADER
       ========================= */
    header.hero{
      position:relative;
      min-height:70vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      border-bottom-left-radius:28px;
      border-bottom-right-radius:28px;
      margin-bottom:28px;
      box-shadow:0 8px 30px rgba(2,48,71,0.08);
    }
    header.hero video{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      filter:brightness(.56) contrast(1.02) saturate(1.05);
      transform:scale(1.03);
      z-index:0;
    }
    header.hero .overlay{
      position:absolute; inset:0;
      background:linear-gradient(180deg, rgba(0,0,0,0.14), rgba(0,0,0,0.12));
      z-index:1;
    }
    .nav{
      position:absolute;
      top:18px;
      left:50%;
      transform:translateX(-50%);
      z-index:12;
      display:flex;
      gap:8px;
      background: rgba(255,255,255,0.06);
      padding:8px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
      box-shadow:0 6px 20px rgba(0,0,0,0.06);
    }
    .nav a{
      color:#e8f7ff;
      font-weight:700;
      padding:8px 12px;
      border-radius:8px;
      font-size:14px;
    }
    .nav a:hover{ background: rgba(255,255,255,0.04); transform:translateY(-2px) }

    .hero-inner{
      position:relative;
      z-index:10;
      width:100%;
      max-width:var(--maxw);
      padding:44px 24px;
      display:grid;
      grid-template-columns: 1fr 380px;
      gap:28px;
      align-items:center;
      color:#f8fbff;
    }
    @media (max-width:980px){ .hero-inner{ grid-template-columns:1fr; padding-top:36px } .nav{ top:10px } }

    .hero-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-radius:14px;
      padding:26px;
      box-shadow: 0 8px 30px rgba(2,48,71,0.18);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.06);
    }
    .brand{ display:flex; gap:12px; align-items:center; }
    .logo{ width:64px; height:64px; background:linear-gradient(135deg,var(--accent),var(--ocean-700)); border-radius:12px; display:flex; align-items:center; justify-content:center; color:white; font-weight:800; font-size:22px; box-shadow:0 6px 18px rgba(0,0,0,0.18); }
    h1{ font-size:28px; margin:4px 0 0; font-weight:800; letter-spacing:-0.4px }
    p.lead{ margin:10px 0 12px; opacity:.95; font-weight:500; color:#eaf8ff }

    .cta-row{ display:flex; gap:12px; flex-wrap:wrap }
    .btn{
      background:var(--accent);
      color:#002b3a;
      padding:10px 16px;
      border-radius:10px;
      font-weight:800;
      border:none;
      cursor:pointer;
      box-shadow:0 6px 20px rgba(0,180,216,0.12);
      transition:transform .12s, box-shadow .12s;
    }
    .btn:hover{ transform:translateY(-4px); box-shadow:0 14px 30px rgba(0,180,216,0.16) }
    .btn.secondary{ background:transparent; color:#dff6ff; border:1px solid rgba(255,255,255,0.12); }

    /* =========================
       LAYOUT
       ========================= */
    .container{ max-width:var(--maxw); margin:0 auto; padding:0 20px; }
    .section{ margin:24px auto; }
    .card{ background:var(--card); padding:16px; border-radius:12px; box-shadow:0 8px 22px rgba(2,48,71,0.06); border:1px solid rgba(2,48,71,0.04); }

    .grid{ display:grid; grid-template-columns:repeat(12,1fr); gap:16px; align-items:start; }
    .col-7{ grid-column:span 7 }
    .col-5{ grid-column:span 5 }
    @media (max-width:900px){ .col-7,.col-5{ grid-column:1 / -1 } }

    h2{ color:var(--ocean-700); margin-bottom:12px }
    .muted{ color:var(--muted); font-weight:500 }

    /* GALLERY */
    .gallery{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:12px; margin-top:8px; }
    .gallery img{ width:100%; height:160px; object-fit:cover; border-radius:10px; transition: transform .18s, box-shadow .18s; cursor:pointer }
    .gallery img:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(2,48,71,0.12); }

    /* GAMES */
    .games{ display:flex; gap:18px; margin-top:12px; align-items:flex-start; flex-wrap:wrap; }
    .game{ flex:1 1 340px; min-height:260px; background:linear-gradient(180deg,#fff,#f8fbff); border-radius:12px; padding:12px; box-shadow:0 10px 30px rgba(2,48,71,0.06); }
    .game canvas{ width:100%; height:180px; background: linear-gradient(180deg,#e8f6ff,#ffffff); border-radius:8px; display:block; }

    /* specific UI for game categories */
    .game-controls{ display:flex; gap:8px; align-items:center; margin-top:8px; }
    .game-controls .status{ margin-left:auto; font-weight:700; color:var(--ocean-700); }

    /* QUIZ */
    #quizArea > div{ margin-bottom:10px; }

    /* RESERVAS */
    input, textarea, select{ padding:10px; border-radius:8px; border:1px solid #d2e9f6; font-size:14px; }
    textarea{ min-height:88px; }

    footer{ margin-top:34px; padding:20px; background:linear-gradient(90deg,var(--ocean-900),var(--ocean-700)); color:white; border-radius:12px; max-width:var(--maxw); margin-left:auto; margin-right:auto; }

    /* small helpers */
    .small{ font-size:13px; color:var(--muted) }
    .badge{ background:var(--gold); color:#00303a; padding:6px 10px; border-radius:8px; font-weight:800; font-size:12px }
    .center{ text-align:center }
    code{ background:#f1f8ff; padding:2px 6px; border-radius:6px; }
  </style>
</head>
<body>

  <!-- HERO -->
  <header class="hero" role="banner" aria-label="Cabecera Cronoviajes">
    <!-- VIDEO (externo): Pexels/Pixabay ejemplo. Si la URL falla, c√°mbiala por otra p√∫blica -->
    <video id="bgVideo" autoplay loop muted playsinline preload="auto">
      <source src="https://cdn.pixabay.com/vimeo/493406999/pexels-tima-miroshnichenko-8553800-2048x1152.mp4?hash=8899b6d0f4f8a1f6eaf0f2b3f2a1f7c5d2d9b7b2" type="video/mp4">
      <!-- fallback: imagen de fondo -->
    </video>
    <div class="overlay"></div>

    <!-- NAV -->
    <nav class="nav" aria-label="Navegaci√≥n">
      <a href="#inicio">Inicio</a>
      <a href="#galeria">Galer√≠a</a>
      <a href="#info">Informaci√≥n</a>
      <a href="#juegos">Juegos</a>
      <a href="#reservas">Reservas</a>
    </nav>

    <div class="hero-inner container">
      <div class="hero-card" role="region" aria-labelledby="hero-title">
        <div class="brand">
          <div class="logo" aria-hidden="true">Cv</div>
          <div>
            <div style="display:flex; gap:8px; align-items:center;">
              <h1 id="hero-title">Cronoviajes ‚Äî Viajes al C√°mbrico</h1>
              <div class="badge">Educativo</div>
            </div>
            <p class="lead">Regresa 541 millones de a√±os y explora los primeros ecosistemas marinos ‚Äî simulaciones seguras y educativas.</p>
          </div>
        </div>

        <div class="cta-row" style="margin-top:14px;">
          <button class="btn" id="btnReservaHero">Reservar experiencia</button>
          <button class="btn secondary" id="toggleSound">üîà Audio: ON</button>
        </div>

        <p class="small" style="margin-top:12px">Recomendado: auriculares para mejor experiencia. Pulsa el bot√≥n de audio para activar/desactivar.</p>
      </div>

      <div>
        <div class="card" role="region" aria-labelledby="why">
          <h3 id="why" style="margin:0 0 8px">¬øPor qu√© el C√°mbrico?</h3>
          <p class="small">La Explosi√≥n C√°mbrica marc√≥ la aparici√≥n de formas de vida complejas en los oc√©anos. √ötil para aprender biolog√≠a evolutiva y paleontolog√≠a.</p>
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
            <div style="background:linear-gradient(180deg,#f8fdff,#eef7fb); padding:8px 10px; border-radius:10px; font-weight:700;">ü¶ê Trilobites</div>
            <div style="background:linear-gradient(180deg,#f8fdff,#eef7fb); padding:8px 10px; border-radius:10px; font-weight:700;">ü¶¥ F√≥siles</div>
            <div style="background:linear-gradient(180deg,#f8fdff,#eef7fb); padding:8px 10px; border-radius:10px; font-weight:700;">ü™∏ Pikaia</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main>

    <!-- INICIO -->
    <section id="inicio" class="section container" aria-labelledby="inicio-title">
      <div class="grid">
        <div class="col-7">
          <div class="card">
            <h2 id="inicio-title">Bienvenido al C√°mbrico</h2>
            <p class="small">Hace <strong>~541 millones de a√±os</strong> empez√≥ el C√°mbrico: una explosi√≥n de diversidad marina. En Cronoviajes ofrecemos experiencias educativas simuladas, galer√≠as y minijuegos.</p>

            <div style="display:flex; gap:12px; margin-top:12px; flex-wrap:wrap;">
              <div style="flex:1; min-width:160px;">
                <h4 style="margin:0 0 6px">Clima</h4>
                <p class="small">C√°lido, sin casquetes polares.</p>
              </div>
              <div style="flex:1; min-width:160px;">
                <h4 style="margin:0 0 6px">Fauna</h4>
                <p class="small">Trilobites, anomaloc√°ridos, opabinia, pikaia.</p>
              </div>
              <div style="flex:1; min-width:160px;">
                <h4 style="margin:0 0 6px">Objetivo</h4>
                <p class="small">Aprender mediante observaci√≥n y juegos interactivos.</p>
              </div>
            </div>
          </div>

          <div style="height:18px"></div>

          <!-- QUIZ RAPIDO -->
          <div class="card">
            <h3>Test r√°pido</h3>
            <div id="quickQuiz" style="margin-top:8px"></div>
            <div style="margin-top:10px;">
              <button class="btn" id="startQuickQuizBtn">Iniciar test</button>
              <button class="btn secondary" id="checkQuickQuizBtn">Comprobar</button>
              <p id="quickQuizResult" class="small" style="margin-top:8px"></p>
            </div>
          </div>

        </div>

        <aside class="col-5">
          <div class="card">
            <h3>Reservas r√°pidas</h3>
            <form id="reserveForm">
              <label class="small">Nombre completo</label>
              <input id="rname" placeholder="Tu nombre" required>
              <label class="small">Email</label>
              <input id="remail" type="email" placeholder="correo@ejemplo.com" required>
              <label class="small">Fecha</label>
              <input id="rdate" type="date" required>
              <label class="small">N¬∫ viajeros</label>
              <select id="rpeople">
                <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
              </select>
              <button class="btn" style="margin-top:8px" type="submit">Enviar</button>
              <p id="reserveMsg" class="small" style="margin-top:8px"></p>
            </form>
          </div>

          <div style="height:12px"></div>

          <div class="card">
            <h4>Testimonios</h4>
            <p class="small">‚ÄúImpresionante y educativo‚Äù ‚Äî <strong>Dra. M. Ruiz</strong></p>
            <p class="small">‚ÄúRecomendado para colegios‚Äù ‚Äî <strong>I.E.S. Central</strong></p>
          </div>
        </aside>
      </div>
    </section>

    <!-- GALERIA -->
    <section id="galeria" class="section container" aria-labelledby="galeria-title">
      <div class="card">
        <h2 id="galeria-title">Galer√≠a</h2>
        <p class="small">A√±ade tus propias fotos en la carpeta <code>images/</code>. Instrucciones abajo.</p>
        <div class="gallery" id="galleryGrid" style="margin-top:12px">
          <!-- Im√°genes por defecto (si no pones las tuyas, aparecen rotas; reemplaza src con tus URLs o sube a images/) -->
          <img src="images/trilobite.jpg" alt="Trilobite" loading="lazy">
          <img src="images/anomalocaris.jpg" alt="Anomalocaris" loading="lazy">
          <img src="images/opabinia.jpg" alt="Opabinia" loading="lazy">
          <img src="images/hallucigenia.jpg" alt="Hallucigenia" loading="lazy">
          <img src="images/pikaia.jpg" alt="Pikaia" loading="lazy">
        </div>
      </div>
    </section>

    <!-- INFO DETALLADA -->
    <section id="info" class="section container" aria-labelledby="info-title">
      <div class="card">
        <h2 id="info-title">Informaci√≥n detallada</h2>
        <h3 style="margin-top:8px">Eventos clave</h3>
        <ul class="small">
          <li>Inicio: Explosi√≥n C√°mbrica (~541 millones de a√±os).</li>
          <li>Fin: transici√≥n Ordov√≠cico (~485 millones de a√±os).</li>
        </ul>

        <h3 style="margin-top:8px">Clima y nivel del mar</h3>
        <ul class="small">
          <li>Clima m√°s c√°lido, mares extensos sin hielo polar.</li>
        </ul>

        <h3 style="margin-top:8px">F√≥siles</h3>
        <ul class="small">
          <li>Trilobites, braqui√≥podos, anomalocaris, opabinia, pikaia, small shelly fauna.</li>
        </ul>
      </div>
    </section>

    <!-- JUEGOS (tres categor√≠as individuales) -->
    <section id="juegos" class="section container" aria-labelledby="juegos-title">
      <div class="card">
        <h2 id="juegos-title">Zona de juegos</h2>
        <p class="small">Tres juegos independientes: pulsa el bot√≥n de inicio del juego que quieras jugar ‚Äî ninguno arrancar√° autom√°ticamente.</p>

        <div class="games">

          <!-- Juego A: Quiz avanzado (categor√≠a "Quiz") -->
          <div class="game" id="gameQuiz" aria-label="Categor√≠a Quiz">
            <h4>Quiz: Preguntas del C√°mbrico</h4>
            <div id="quizAreaAdvanced" style="margin-top:8px"></div>
            <div class="game-controls">
              <button class="btn" id="startQuizAdvBtn">Iniciar Quiz</button>
              <button class="btn secondary" id="submitQuizAdvBtn">Comprobar respuestas</button>
              <div class="status" id="quizAdvStatus">Estado: inactivo</div>
            </div>
            <p class="small" style="margin-top:8px">Modo educativo: responde y aprende. Cada respuesta correcta suma puntos.</p>
          </div>

          <!-- Juego B: Submarino (categor√≠a "Submarino") -->
          <div class="game" id="gameSubmarine" aria-label="Categor√≠a Submarino">
            <h4>Submarino temporal</h4>
            <canvas id="canvasSub" width="620" height="220" role="img" aria-label="Canvas submarino"></canvas>
            <div class="game-controls">
              <button class="btn" id="startSubBtn">Iniciar Submarino</button>
              <button class="btn secondary" id="stopSubBtn">Parar / Reiniciar</button>
              <div class="status" id="subStatus">Puntuaci√≥n: <strong id="subPoints">0</strong></div>
            </div>
            <p class="small" style="margin-top:8px">Mueve el rat√≥n o toca el canvas para mover el submarino. Recolecta solo √≠tems c√°mbricos (verde) y evita los modernos (rojo).</p>
          </div>

          <!-- Juego C: Avi√≥n atrapapalabras (categor√≠a "Avi√≥n") -->
          <div class="game" id="gamePlaneCategory" aria-label="Categor√≠a Avi√≥n">
            <h4>Vuelo del tiempo ‚Äî Avi√≥n atrapapalabras</h4>
            <canvas id="canvasPlane" width="620" height="220" role="img" aria-label="Canvas avi√≥n"></canvas>
            <div class="game-controls">
              <button class="btn" id="startPlaneBtn">Iniciar Vuelo</button>
              <button class="btn secondary" id="stopPlaneBtn">Parar / Reiniciar</button>
              <div class="status" id="planeStatus">Puntos: <strong id="planePoints">0</strong></div>
            </div>
            <p class="small" style="margin-top:8px">Mueve el cursor dentro del canvas para mover el avi√≥n. Atrapa palabras que respondan a la pregunta que aparece arriba del canvas.</p>
          </div>

        </div>
      </div>
    </section>

    <!-- RESERVAS -->
    <section id="reservas" class="section container" aria-labelledby="reservas-title">
      <div class="card">
        <h2 id="reservas-title">Reservas & contacto</h2>
        <div style="display:grid; grid-template-columns:1fr 360px; gap:18px">
          <div>
            <p class="small">Rellena y enviamos una confirmaci√≥n simulada.</p>
            <form id="contactForm">
              <label class="small">Nombre</label><input id="cname" required placeholder="Nombre">
              <label class="small">Email</label><input id="cemail" type="email" required placeholder="correo@ejemplo.com">
              <label class="small">Mensaje</label><textarea id="cmsg" placeholder="¬øAlguna petici√≥n?"></textarea>
              <button class="btn" style="margin-top:8px" type="submit">Enviar</button>
              <p id="contactMsg" class="small" style="margin-top:8px"></p>
            </form>
          </div>

          <div>
            <h4>Informaci√≥n pr√°ctica</h4>
            <ul class="small">
              <li>Duraci√≥n simulada: 3‚Äì6 horas.</li>
              <li>Capacidad: 1‚Äì6 por sesi√≥n (simulaci√≥n educativa).</li>
              <li>Localizaci√≥n: plataforma virtual (no viajes reales).</li>
            </ul>
            <div style="height:12px"></div>
            <h4>Redes</h4>
            <div style="display:flex; gap:8px; flex-wrap:wrap;">
              <div style="background:rgba(0,0,0,0.06); padding:8px 12px; border-radius:999px;">Twitter</div>
              <div style="background:rgba(0,0,0,0.06); padding:8px 12px; border-radius:999px;">Instagram</div>
              <div style="background:rgba(0,0,0,0.06); padding:8px 12px; border-radius:999px;">YouTube</div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer>
    <div style="display:flex; justify-content:space-between; gap:12px; align-items:center; flex-wrap:wrap;">
      <div>
        <strong>Cronoviajes S.A.</strong>
        <div class="small">¬© <span id="year"></span> Proyecto educativo ‚Äî Viaje al C√°mbrico</div>
      </div>
      <div class="small">Contacto: <a href="mailto:info@cronoviajes.example" style="color:inherit; text-decoration:underline">info@cronoviajes.example</a></div>
    </div>
  </footer>

  <!-- AUDIO (externo) -->
  <!-- ejemplo de audio ambiente desde freesound CDN o fuente p√∫blica; puedes cambiar la URL por otra -->
  <audio id="ambientAudio" loop preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2021/08/09/audio_67d8d7e9d2.mp3?filename=ocean-waves-ambient-11209.mp3" type="audio/mpeg">
    <!-- fallback audio local si lo subes -->
  </audio>
  <audio id="clickSound" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0b6de7f94d.mp3?filename=short-pop-6298.mp3" type="audio/mpeg">
  </audio>

  <!-- ============ SCRIPTS: l√≥gica completa ============ -->
  <script>
  /****************************************************************************
   * Cronoviajes - Script completo
   * - Juegos no arrancan autom√°ticamente: requieren bot√≥n de inicio.
   * - Tres categor√≠as de juegos independientes.
   ****************************************************************************/

  // UTIL / UI
  document.getElementById('year').textContent = new Date().getFullYear();

  // Audio controls
  const ambient = document.getElementById('ambientAudio');
  const clickSnd = document.getElementById('clickSound');
  let audioOn = true;
  ambient.volume = 0.14;
  // intentamos reproducir (puede bloquearlo el navegador)
  ambient.play().catch(()=>{ ambient.muted = true; audioOn = false; document.getElementById('toggleSound').textContent='üîà Audio: OFF' });

  document.getElementById('toggleSound').addEventListener('click', ()=>{
    audioOn = !audioOn;
    if(audioOn){ ambient.muted = false; document.getElementById('toggleSound').textContent='üîä Audio: ON'; }
    else { ambient.muted = true; document.getElementById('toggleSound').textContent='üîà Audio: OFF'; }
    clickSnd.play().catch(()=>{});
  });
  // Hero reservation scroll
  document.getElementById('btnReservaHero').addEventListener('click', ()=> {
    document.getElementById('reservas').scrollIntoView({behavior:'smooth'});
    clickSnd.play().catch(()=>{});
  });

  // Reserve form simulation
  document.getElementById('reserveForm').addEventListener('submit', function(e){
    e.preventDefault();
    const n = document.getElementById('rname').value || 'Amigo/a';
    document.getElementById('reserveMsg').textContent = `Gracias ${n}. Reserva simulada recibida.`;
    clickSnd.play().catch(()=>{});
  });

  document.getElementById('contactForm').addEventListener('submit', function(e){
    e.preventDefault();
    const n = document.getElementById('cname').value || 'Amigo/a';
    document.getElementById('contactMsg').textContent = `Gracias ${n}. Mensaje enviado (simulado).`;
    clickSnd.play().catch(()=>{});
  });

  /*************************
   * QUICK QUIZ (inicio manual)
   *************************/
  const quickQuizData = [
    {q:'¬øHace cu√°ntos millones de a√±os empez√≥ el C√°mbrico?', a:'541'},
    {q:'Nombre de un famoso trilobite (respuesta tipo)', a:'trilobite'}
  ];
  const quickQuizDiv = document.getElementById('quickQuiz');
  function buildQuickQuiz(){
    quickQuizDiv.innerHTML = '';
    quickQuizData.forEach((it, idx)=>{
      const d = document.createElement('div');
      d.innerHTML = `<strong>${idx+1}.</strong> ${it.q}<div style="margin-top:6px"><input id="qq${idx}" style="width:100%; padding:8px; border-radius:6px; border:1px solid #dfeffb;"></div>`;
      quickQuizDiv.appendChild(d);
    });
    document.getElementById('quickQuizResult').textContent = '';
  }
  document.getElementById('startQuickQuizBtn').addEventListener('click', ()=>{
    buildQuickQuiz();
    document.getElementById('quickQuizResult').textContent = 'Test iniciado. Responde y pulsa "Comprobar".';
    clickSnd.play().catch(()=>{});
  });
  document.getElementById('checkQuickQuizBtn').addEventListener('click', ()=>{
    let score = 0;
    quickQuizData.forEach((it, idx)=>{
      const v = (document.getElementById('qq'+idx)?.value || '').toLowerCase();
      if(v.includes(it.a)) score++;
    });
    document.getElementById('quickQuizResult').textContent = `Has acertado ${score} de ${quickQuizData.length}`;
    clickSnd.play().catch(()=>{});
  });

  /***************************************
   * GAME A: Quiz avanzado (categoria individual)
   * - No empieza hasta pulsar Start
   ****************************************/
  const quizAdvancedData = [
    {q:'¬øHace cu√°ntos millones de a√±os comenz√≥ el C√°mbrico?', a:'541'},
    {q:'Cita un depredador destacado del C√°mbrico', a:'anomalocaris'},
    {q:'Nombre del cordado primitivo muy conocido', a:'pikaia'},
    {q:'Organismo con cinco ojos', a:'opabinia'},
    {q:'Nombre del evento de aparici√≥n masiva', a:'explosi√≥n c√°mbrica'}
  ];
  const quizAreaAdv = document.getElementById('quizAreaAdvanced');
  let quizAdvActive = false;

  function buildQuizAdvanced(){
    quizAreaAdv.innerHTML = '';
    quizAdvancedData.forEach((it,i)=>{
      const div = document.createElement('div');
      div.innerHTML = `<strong>${i+1}.</strong> ${it.q}<div style="margin-top:6px"><input id="qa${i}" style="width:100%; padding:8px; border-radius:6px; border:1px solid #dfeffb;"></div>`;
      quizAreaAdv.appendChild(div);
    });
    document.getElementById('quizAdvStatus').textContent = 'Estado: activo (responde y pulsa comprobar)';
  }

  document.getElementById('startQuizAdvBtn').addEventListener('click', ()=>{
    quizAdvActive = true;
    buildQuizAdvanced();
    clickSnd.play().catch(()=>{});
  });

  document.getElementById('submitQuizAdvBtn').addEventListener('click', ()=>{
    if(!quizAdvActive){ document.getElementById('quizAdvStatus').textContent = 'Estado: inactivo (pulsa Iniciar Quiz)'; return; }
    let score = 0;
    quizAdvancedData.forEach((it,i)=>{
      const v = (document.getElementById('qa'+i)?.value || '').toLowerCase();
      if(v.includes(it.a)) score++;
    });
    document.getElementById('quizAdvStatus').textContent = `Estado: terminado ‚Äî Has acertado ${score}/${quizAdvancedData.length}`;
    if(score === quizAdvancedData.length){ new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_0b6de7f94d.mp3').play().catch(()=>{}); }
    clickSnd.play().catch(()=>{});
  });

  /***************************************
   * GAME B: Submarino temporal
   * - Se inicia con bot√≥n StartSubBtn
   * - Se puede reiniciar con StopSubBtn
   ****************************************/
  const canvasSub = document.getElementById('canvasSub');
  const ctxSub = canvasSub.getContext('2d');
  let subState = null;

  function initSubState(){
    subState = {
      running:false,
      player:{x:40, y: canvasSub.height/2, w:56, h:26},
      items:[],
      tick:0,
      score:0,
      spawnRate: 70,
      mouseY: undefined
    };
    document.getElementById('subPoints').textContent = subState.score;
    drawSubInstructions();
  }

  function drawSubInstructions(){
    ctxSub.clearRect(0,0,canvasSub.width,canvasSub.height);
    const g = ctxSub.createLinearGradient(0,0,0,canvasSub.height);
    g.addColorStop(0,'#e6f8ff'); g.addColorStop(1,'#d9f3ff');
    ctxSub.fillStyle = g; ctxSub.fillRect(0,0,canvasSub.width,canvasSub.height);
    ctxSub.fillStyle = '#003a55';
    ctxSub.font = '14px Poppins';
    ctxSub.fillText('Pulsa "Iniciar Submarino" y mueve el rat√≥n en el canvas para controlar el submarino.', 12, 22);
  }

  function spawnSubItem(){
    const pool = [
      {label:'trilobite', ok:true},
      {label:'anomalocaris', ok:true},
      {label:'pikaia', ok:true},
      {label:'opabinia', ok:true},
      {label:'t-rex', ok:false},
      {label:'aves', ok:false},
      {label:'manzana', ok:false},
      {label:'carro', ok:false}
    ];
    const pick = pool[Math.floor(Math.random()*pool.length)];
    subState.items.push({
      x: canvasSub.width + 40,
      y: 30 + Math.random()*(canvasSub.height-60),
      vx: -2 - Math.random()*2,
      label: pick.label,
      ok: pick.ok,
      size: 12 + Math.random()*12
    });
  }

  function subLoop(){
    if(!subState.running) return;
    subState.tick++;
    if(subState.tick % subState.spawnRate === 0) spawnSubItem();

    // clear
    ctxSub.clearRect(0,0,canvasSub.width,canvasSub.height);

    // background
    const g = ctxSub.createLinearGradient(0,0,0,canvasSub.height);
    g.addColorStop(0,'#e6f8ff'); g.addColorStop(1,'#d9f3ff');
    ctxSub.fillStyle = g; ctxSub.fillRect(0,0,canvasSub.width,canvasSub.height);

    // seabed
    ctxSub.fillStyle = '#cdeff8'; ctxSub.fillRect(0, canvasSub.height-18, canvasSub.width, 18);

    // player
    const p = subState.player;
    ctxSub.fillStyle = '#0077b6'; ctxSub.fillRect(p.x, p.y, p.w, p.h);
    ctxSub.fillStyle = '#00b4d8'; ctxSub.fillRect(p.x+8, p.y+6, p.w-16, p.h-12);

    // items
    for(let i=subState.items.length-1;i>=0;i--){
      const it = subState.items[i];
      it.x += it.vx;
      ctxSub.fillStyle = it.ok ? 'rgba(42,157,143,0.95)' : 'rgba(214,40,40,0.95)';
      ctxSub.beginPath();
      ctxSub.arc(it.x, it.y, it.size, 0, Math.PI*2);
      ctxSub.fill();
      ctxSub.fillStyle = '#fff';
      ctxSub.font = '12px Poppins';
      ctxSub.fillText(it.label, it.x - it.size, it.y - it.size - 6);

      // collision
      if(it.x < p.x + p.w && it.x > p.x && it.y > p.y && it.y < p.y + p.h){
        if(it.ok) subState.score += 10; else subState.score = Math.max(0, subState.score - 5);
        subState.items.splice(i,1);
        document.getElementById('subPoints').textContent = subState.score;
        clickSnd.play().catch(()=>{});
      } else if(it.x < -40){
        subState.items.splice(i,1);
      }
    }

    // smooth follow of mouseY
    if(subState.mouseY !== undefined){
      p.y += (subState.mouseY - p.y - p.h/2) * 0.14;
      if(p.y < 6) p.y = 6;
      if(p.y > canvasSub.height - p.h - 6) p.y = canvasSub.height - p.h - 6;
    }

    // HUD
    ctxSub.fillStyle = '#003a55'; ctxSub.font = '13px Poppins';
    ctxSub.fillText('Recolecta f√≥siles c√°mbricos (verde). Evita lo moderno (rojo).', 10, 18);

    requestAnimationFrame(subLoop);
  }

  document.getElementById('startSubBtn').addEventListener('click', ()=>{
    if(!subState) initSubState();
    subState.running = true;
    subLoop();
    clickSnd.play().catch(()=>{});
  });

  document.getElementById('stopSubBtn').addEventListener('click', ()=>{
    initSubState();
    clickSnd.play().catch(()=>{});
  });

  canvasSub.addEventListener('mousemove', (e)=>{
    const r = canvasSub.getBoundingClientRect();
    if(subState) subState.mouseY = e.clientY - r.top;
  });
  canvasSub.addEventListener('touchmove', (e)=>{
    const r = canvasSub.getBoundingClientRect();
    if(e.touches && e.touches[0]) {
      const ty = e.touches[0].clientY - r.top;
      if(subState) subState.mouseY = ty;
    }
    e.preventDefault();
  }, { passive:false });

  initSubState(); // draw initial instructions

  /***************************************
   * GAME C: Avi√≥n atrapapalabras (mejorado)
   * - Inicio con bot√≥n startPlaneBtn
   * - Reinicio con stopPlaneBtn
   ****************************************/
  const canvasPlane = document.getElementById('canvasPlane');
  const ctxPlane = canvasPlane.getContext('2d');
  let planeState = null;

  const planeQuestions = [
    {q:'Depredador del C√°mbrico', correct:['anomalocaris','opabinia']},
    {q:'Cordado primitivo', correct:['pikaia']},
    {q:'Elemento t√≠pico', correct:['trilobite','braqui√≥podo']},
    {q:'Organismo con cinco ojos', correct:['opabinia']},
  ];

  function initPlaneState(){
    planeState = {
      running:false,
      score:0,
      player:{x: canvasPlane.width/2, y: canvasPlane.height - 28, w:40, h:18},
      words:[],
      tick:0,
      currentQ: planeQuestions[Math.floor(Math.random()*planeQuestions.length)],
      mouseX: undefined
    };
    document.getElementById('planePoints').textContent = planeState.score;
    drawPlaneInstructions();
  }

  function drawPlaneInstructions(){
    ctxPlane.clearRect(0,0,canvasPlane.width,canvasPlane.height);
    ctxPlane.fillStyle = '#005f7f'; ctxPlane.font = '15px Poppins';
    ctxPlane.fillText('Pulsa "Iniciar Vuelo" y mueve el rat√≥n dentro del canvas para mover el avi√≥n.', 10, 20);
  }

  function spawnPlaneWord(){
    const pool = ['trilobite','anomalocaris','pikaia','dinosaurio','alga','opabinia','pez','estrella','braqui√≥podo','f√≥sil','c√°mbrico','vida'];
    const w = pool[Math.floor(Math.random()*pool.length)];
    planeState.words.push({
      x: 30 + Math.random()*(canvasPlane.width-60),
      y: -20,
      vy: 1 + Math.random()*1.6,
      text: w
    });
  }

  function planeLoop(){
    if(!planeState.running) return;
    planeState.tick++;
    if(planeState.tick % 60 === 0) spawnPlaneWord();

    // clear
    ctxPlane.clearRect(0,0,canvasPlane.width,canvasPlane.height);
    // bg
    const g = ctxPlane.createLinearGradient(0,0,0,canvasPlane.height);
    g.addColorStop(0,'#fff7f0'); g.addColorStop(1,'#e8f7ff');
    ctxPlane.fillStyle = g; ctxPlane.fillRect(0,0,canvasPlane.width,canvasPlane.height);

    // question
    ctxPlane.fillStyle = '#005f7f'; ctxPlane.font = '15px Poppins';
    ctxPlane.fillText('Pregunta: ' + planeState.currentQ.q, 10, 20);

    // draw plane (triangle)
    const pl = planeState.player;
    ctxPlane.fillStyle = '#0077b6';
    ctxPlane.beginPath();
    ctxPlane.moveTo(pl.x, pl.y);
    ctxPlane.lineTo(pl.x-22, pl.y+16);
    ctxPlane.lineTo(pl.x+22, pl.y+16);
    ctxPlane.closePath();
    ctxPlane.fill();

    // words
    for(let i=planeState.words.length-1;i>=0;i--){
      const it = planeState.words[i];
      it.y += it.vy;
      // draw label
      ctxPlane.fillStyle = '#ffd166';
      ctxPlane.font = '13px Poppins';
      const tw = ctxPlane.measureText(it.text).width + 14;
      const rx = it.x - tw/2;
      ctxPlane.fillRect(rx, it.y - 14, tw, 22);
      ctxPlane.fillStyle = '#00303a';
      ctxPlane.fillText(it.text, rx + 7, it.y + 4);

      // collision
      if(it.y > pl.y - 10 && it.y < pl.y + 18 && Math.abs(it.x - pl.x) < 28){
        const correctList = planeState.currentQ.correct;
        if(correctList.includes(it.text)){
          planeState.score += 10;
          // new question
          planeState.currentQ = planeQuestions[Math.floor(Math.random()*planeQuestions.length)];
          clickSnd.play().catch(()=>{});
        } else {
          planeState.score = Math.max(0, planeState.score - 5);
        }
        planeState.words.splice(i,1);
        document.getElementById('planePoints').textContent = planeState.score;
      } else if(it.y > canvasPlane.height + 30){
        planeState.words.splice(i,1);
      }
    }

    // move plane
    if(planeState.mouseX !== undefined){
      pl.x += (planeState.mouseX - pl.x) * 0.12;
      if(pl.x < 22) pl.x = 22;
      if(pl.x > canvasPlane.width - 22) pl.x = canvasPlane.width - 22;
    }

    requestAnimationFrame(planeLoop);
  }

  document.getElementById('startPlaneBtn').addEventListener('click', ()=>{
    if(!planeState) initPlaneState();
    planeState.running = true;
    planeLoop();
    clickSnd.play().catch(()=>{});
  });

  document.getElementById('stopPlaneBtn').addEventListener('click', ()=>{
    initPlaneState();
    clickSnd.play().catch(()=>{});
  });

  canvasPlane.addEventListener('mousemove', (e)=>{
    const r = canvasPlane.getBoundingClientRect();
    if(planeState) planeState.mouseX = e.clientX - r.left;
  });
  canvasPlane.addEventListener('touchmove', (e)=>{
    const r = canvasPlane.getBoundingClientRect();
    if(e.touches && e.touches[0]){
      const tx = e.touches[0].clientX - r.left;
      if(planeState) planeState.mouseX = tx;
    }
    e.preventDefault();
  }, { passive:false });

  initPlaneState();

  /***********************************************
   * Helpers: fix canvas DPI on resize for crisp UI
   ***********************************************/
  function fixDPI(canvas){
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    if(rect.width === 0 || rect.height === 0) return;
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    const ctx = canvas.getContext('2d');
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  // adjust canvases after layout
  function adjustAllCanvases(){
    [canvasSub, canvasPlane].forEach(c=>{ try{ fixDPI(c); }catch(e){} });
    drawSubInstructions();
    drawPlaneInstructions();
  }
  window.addEventListener('resize', ()=>{ setTimeout(adjustAllCanvases, 60); });
  setTimeout(adjustAllCanvases, 120);

  /****************************************
   * Gallery: lightbox simple
   ****************************************/
  // simple modal lightbox
  document.getElementById('galleryGrid').addEventListener('click', (e)=>{
    if(e.target && e.target.tagName === 'IMG'){
      openLightbox(e.target.src, e.target.alt || '');
    }
  });

  function openLightbox(src, alt){
    const overlay = document.createElement('div');
    overlay.style.position='fixed'; overlay.style.inset=0; overlay.style.background='rgba(0,0,0,0.8)';
    overlay.style.display='flex'; overlay.style.alignItems='center'; overlay.style.justifyContent='center';
    overlay.style.zIndex=9999;
    const img = document.createElement('img');
    img.src = src; img.alt = alt; img.style.maxWidth='90%'; img.style.maxHeight='90%'; img.style.borderRadius='10px';
    overlay.appendChild(img);
    overlay.addEventListener('click', ()=> overlay.remove());
    document.body.appendChild(overlay);
  }

  /****************************************
   * FIN DEL SCRIPT
   ****************************************/
  console.log('Cronoviajes: script cargado. Juegos: requieren iniciar manualmente. A√±ade tus fotos en /images y cambia video/audio si quieres.');
  </script>

</body>
</html>

