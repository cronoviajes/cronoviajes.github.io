<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cronoviajes — Descubre el pasado, vive el origen</title>
  <meta name="description" content="Cronoviajes: Agencia de viajes al Cámbrico. Experiencias, galería, juegos y reservas con calendario interactivo. Proyecto educativo.">
  <meta name="author" content="Cronoviajes S.A.">

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* ===================================================
       RESET + VARIABLES
       =================================================== */
    :root{
      --deep:#032b46;        /* azul profundo */
      --sea:#007a9c;         /* turquesa */
      --accent:#00b4d8;      /* acento */
      --gold:#ffd166;        /* dorado */
      --card:#ffffff;
      --muted:#5c7a89;
      --glass: rgba(255,255,255,0.6);
      --radius:14px;
      --maxw:1200px;

      --hero-foreground-light: #ffffff;
      --hero-foreground-dark: #032b46;
      --hero-bg1: linear-gradient(135deg,#145A32,#1D8348); /* verde esmeralda */
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial; color:var(--deep); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    a{ color:inherit; text-decoration:none; }

    /* ===================================================
       LAYOUT: header / topnav / footer
       =================================================== */
    header{
      background: var(--hero-bg1);
      color:var(--hero-foreground-light);
      padding:14px 18px;
    }
    header .topbar{
      max-width:var(--maxw); margin:0 auto; display:flex; justify-content:space-between; align-items:center; gap:12px;
    }
    header h1{ font-family:"Playfair Display", serif; font-size:22px; margin:0; letter-spacing:0.4px; }
    header .slogan{ font-style:italic; opacity:0.95; font-weight:600; font-size:13px; }

    nav.topnav{
      position:sticky; top:8px; z-index:30;
      display:flex; justify-content:center; gap:8px; padding:10px; max-width:var(--maxw); margin:10px auto;
    }
    nav.topnav a{
      padding:8px 12px; border-radius:8px; background:rgba(255,255,255,0.06); color:var(--hero-foreground-light); font-weight:700; box-shadow:0 6px 18px rgba(0,0,0,0.06);
    }
    nav.topnav a:hover{ transform:translateY(-3px); background:rgba(255,255,255,0.09); }

    /* ===================================================
       HERO — slider verde
       =================================================== */
    .hero{
      position:relative;
      height:78vh;
      min-height:520px;
      overflow:hidden;
      background: var(--hero-bg1);
      display:flex;
      align-items:center;
      justify-content:center;
      border-bottom-left-radius:24px;
      border-bottom-right-radius:24px;
      box-shadow: 0 18px 60px rgba(2,32,46,0.12);
    }

    /* slider container */
    .hero .slider{
      position:absolute; inset:0; z-index:0; display:block; overflow:hidden;
    }
    .hero .slide{
      position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transition:opacity 1.2s ease-in-out;
      -webkit-backface-visibility:hidden;
    }
    .hero .slide.active{ opacity:1; }

    /* overlays for contrast control */
    .hero .overlay-dark{ position:absolute; inset:0; background:linear-gradient(180deg, rgba(2,20,10,0.28), rgba(2,40,30,0.24)); z-index:1; pointer-events:none; }
    .hero.light .overlay-dark{ background:linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.5)); }

    /* hero content */
    .hero .inner{
      position:relative; z-index:3; max-width:var(--maxw); width:100%; padding:44px 24px; display:grid; grid-template-columns:1fr 420px; gap:32px; align-items:center;
    }
    @media(max-width:980px){ .hero .inner{ grid-template-columns:1fr; padding:28px 18px } }

    .brand{
      display:flex; gap:14px; align-items:center;
    }
    .logo{
      width:92px; height:92px; border-radius:16px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,var(--gold),var(--accent)); font-weight:900; color:#062328; font-size:28px; box-shadow:0 12px 36px rgba(0,0,0,0.18);
      transition:transform .6s cubic-bezier(.2,.9,.3,1);
    }
    .logo.float{ transform: translateY(-8px) rotate(-6deg); }

    .hero-title{ font-family:"Playfair Display", serif; font-size:44px; color:var(--hero-foreground-light); margin:0; line-height:1.02; }
    .hero-sub{ margin-top:8px; color:var(--hero-foreground-light); font-weight:600; font-size:18px; opacity:0.95; }

    .hero-ctas{ margin-top:18px; display:flex; gap:10px; flex-wrap:wrap; }
    .btn{
      background:var(--accent); color:#05232b; border:none; padding:12px 18px; border-radius:10px; cursor:pointer; font-weight:800;
      box-shadow:0 12px 30px rgba(0,120,160,0.12);
    }
    .btn.secondary{ background:transparent; color:var(--hero-foreground-light); border:1px solid rgba(255,255,255,0.12); }

    .hero-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-radius:12px; padding:16px; box-shadow:0 12px 30px rgba(0,0,0,0.12);
      color:var(--hero-foreground-light);
    }

    /* ===================================================
       MAIN LAYOUT
       =================================================== */
    main{ max-width:var(--maxw); margin:26px auto; padding:0 20px; }

    section.panel{ background:var(--card); border-radius:12px; padding:18px; box-shadow:0 8px 28px rgba(2,32,46,0.06); margin-bottom:20px; }

    h2.section-title{ color:var(--deep); margin-bottom:10px; font-size:22px; }
    .muted{ color:var(--muted); }

    .grid{ display:grid; grid-template-columns:repeat(12,1fr); gap:16px; }
    .col-7{ grid-column: span 7; } .col-5{ grid-column: span 5; }
    @media(max-width:900px){ .col-7,.col-5{ grid-column:1 / -1 } }

    /* GALLERY */
    .gallery{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px; margin-top:8px; }
    .gallery img{ width:100%; height:160px; object-fit:cover; border-radius:10px; cursor:pointer; transition:transform .16s, box-shadow .16s; }
    .gallery img:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(2,48,71,0.12); }

    /* JUEGOS */
    .games{ display:flex; gap:16px; flex-wrap:wrap; margin-top:12px; }
    .game{ flex:1 1 320px; background:linear-gradient(180deg,#fff,#f7feff); border-radius:12px; padding:12px; box-shadow:0 10px 30px rgba(0,0,0,0.06); min-height:260px; }
    .game canvas{ width:100%; height:200px; border-radius:8px; background:linear-gradient(180deg,#e8f6ff,#ffffff); display:block; }

    .game-controls{ display:flex; gap:8px; align-items:center; margin-top:8px; }
    .status{ margin-left:auto; font-weight:700; color:var(--deep); }

    /* CALENDARIO */
    .calendar-wrap{ display:flex; gap:18px; flex-wrap:wrap; margin-top:12px; }
    .calendar{ width:360px; background:var(--card); border-radius:12px; padding:12px; box-shadow:0 8px 20px rgba(0,0,0,0.06); }
    .calendar .month{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
    .calendar .weekdays, .calendar .days{ display:grid; grid-template-columns: repeat(7,1fr); gap:6px; }
    .calendar .day, .calendar .weekday{ padding:8px; border-radius:8px; text-align:center; font-weight:600; color:var(--muted); }
    .day.box{ background:#f6fdff; cursor:pointer; border:1px solid rgba(0,0,0,0.04); }
    .day.disabled{ opacity:0.25; cursor:not-allowed; }
    .day.selected{ background:linear-gradient(180deg,var(--accent), #00d1f0); color:#012; font-weight:800; box-shadow:0 8px 20px rgba(0,120,160,0.12); }
    .day.inrange{ background: linear-gradient(180deg, rgba(0,180,216,0.09), rgba(0,180,216,0.04)); }

    /* FOOTER */
    footer{ margin-top:26px; padding:18px; background:linear-gradient(90deg,var(--deep),var(--sea)); color:#fff; border-radius:12px; max-width:var(--maxw); margin-left:auto; margin-right:auto; text-align:center; }

    /* SMALL */
    .muted-small{ color:var(--muted); font-size:14px; }

    /* accessibility focus */
    a:focus, button:focus, input:focus{ outline: 3px solid rgba(0,180,216,0.18); outline-offset:2px; }

  </style>
</head>

<body>
  <!-- HEADER / NAV -->
  <header>
    <div class="topbar">
      <div style="display:flex; gap:12px; align-items:center;">
        <div class="logo" id="logo">Cv</div>
        <div>
          <h1>Cronoviajes</h1>
          <div class="slogan">Descubre el pasado, vive el origen</div>
        </div>
      </div>
      <div style="font-size:13px; opacity:0.9;">Agencia de viajes al pasado — Proyecto educativo</div>
    </div>
  </header>

  <nav class="topnav" aria-label="Menú principal">
    <a href="#inicio" onclick="scrollToSection('inicio'); return false;">Inicio</a>
    <a href="#galeria" onclick="scrollToSection('galeria'); return false;">Galería</a>
    <a href="#info" onclick="scrollToSection('info'); return false;">Información</a>
    <a href="#juegos" onclick="scrollToSection('juegos'); return false;">Juegos</a>
    <a href="#reservas" onclick="scrollToSection('reservas'); return false;">Reservas</a>
  </nav>

  <!-- HERO (slider verde) -->
  <header class="hero" id="inicio-section" role="banner" aria-label="Portada Cronoviajes">
    <div class="slider" id="heroSlider">
      <!-- 4 imágenes; cámbialas por images/mifotoX.jpg si las subes a /images/ -->
      <img class="slide active" src="https://images.pexels.com/photos/1103569/pexels-photo-1103569.jpeg" alt="Océano antiguo - Cámbrico">
      <img class="slide" src="https://images.pexels.com/photos/159051/sea-ocean-horizon-sky-159051.jpeg" alt="Viaje submarino">
      <img class="slide" src="https://images.pexels.com/photos/1076758/pexels-photo-1076758.jpeg" alt="Investigadores en campo">
      <img class="slide" src="https://images.pexels.com/photos/533923/pexels-photo-533923.jpeg" alt="Paisaje marino antiguo">
    </div>

    <div class="overlay-dark" id="heroOverlay"></div>

    <div class="inner">
      <div>
        <div class="brand">
          <div class="logo" id="logoBadge">Cv</div>
          <div>
            <div class="hero-title">Cronoviajes</div>
            <div class="hero-sub">Descubre el pasado, vive el origen</div>
          </div>
        </div>

        <p style="margin-top:18px; color:rgba(255,255,255,0.95); max-width:62ch;">
          Somos una agencia que organiza viajes al pasado (período Cámbrico). Según el guion del proyecto, ofrecemos viajes organizados con guías científicos: observación de fauna marina, sesiones formativas y rutas controladas en ecosistemas del pasado.
        </p>

        <div class="hero-ctas">
          <button class="btn" id="btnReserve">Reservar viaje temporal</button>
          <button class="btn secondary" id="btnToggleContrast">Alternar contraste</button>
        </div>

        <div style="margin-top:12px; display:flex; gap:8px;">
          <div style="background:rgba(255,255,255,0.08); padding:8px 12px; border-radius:999px; color:#f3fff8; font-weight:700;">Plazas limitadas</div>
          <div style="background:rgba(255,255,255,0.06); padding:8px 12px; border-radius:999px; color:#f3fff8; font-weight:700;">Guias científicos</div>
        </div>
      </div>

      <div>
        <div class="hero-card" aria-hidden="true">
          <h4 style="margin:0 0 8px;">Próximas salidas</h4>
          <p style="margin:0 0 8px;">Consulta disponibilidad en el calendario. Las reservas incluyen briefing científico y seguro de misión.</p>
          <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;">
            <div style="background:#eaf9ff; padding:8px 12px; border-radius:8px; font-weight:700; color:var(--deep);">Cámbrico Explorador</div>
            <div style="background:#fff3d6; padding:8px 12px; border-radius:8px; font-weight:700; color:var(--deep);">Cámbrico Premium</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- GALERÍA -->
    <section class="panel" id="galeria">
      <h2 class="section-title">Galería del Cámbrico</h2>
      <p class="muted">Sube tus imágenes a la carpeta <code>/images/</code> (junto a index.html) o usa enlaces directos. Haz clic en una imagen para ampliarla.</p>
      <div class="gallery" id="galleryGrid" style="margin-top:12px;">
        <!-- Imágenes ejemplo. Cámbialas por images/archivo.jpg si las subes. -->
        <img src="images/trilobite.jpg" alt="Trilobite (ejemplo)" onerror="this.style.display='none'">
        <img src="images/anomalocaris.jpg" alt="Anomalocaris (ejemplo)" onerror="this.style.display='none'">
        <img src="images/opabinia.jpg" alt="Opabinia (ejemplo)" onerror="this.style.display='none'">
        <img src="images/hallucigenia.jpg" alt="Hallucigenia (ejemplo)" onerror="this.style.display='none'">
      </div>
    </section>

    <!-- INFORMACIÓN CIENTÍFICA AMPLIADA -->
    <section class="panel" id="info">
      <h2 class="section-title">Información científica — Período Cámbrico (ampliado)</h2>

      <p class="muted" style="margin-top:8px;">
        El Cámbrico (aprox. 541–485 Ma) es famoso por la <strong>Explosión Cámbrica</strong>, un episodio de rápida diversificación morfológica donde aparecen numerosos filos animales con estructuras duras que facilitan la fossilización.
      </p>

      <h3 style="margin-top:12px;">Geología y tectónica</h3>
      <ul>
        <li>Los continentes estaban fragmentados en microplacas; la dinámica tectónica creó cuencas marinas extensas y plataformas someras, ambientes perfectos para la vida marina.</li>
        <li>La corteza oceánica y la sedimentación rápida favorecieron la preservación de organismos blandos en ciertas condiciones anóxicas (p.ej., Burgess Shale).</li>
        <li>Eventos de transgresión y regresión marina (variaciones del nivel del mar) controlaron la disponibilidad de hábitats costeros y plataformas continentales.</li>
      </ul>

      <h3 style="margin-top:12px;">Clima y química del océano</h3>
      <ul>
        <li>Clima predominantemente cálido; ausencia de grandes casquetes polares.</li>
        <li>Elevados niveles de CO₂ respecto a la era moderna, condiciones tipo invernadero.</li>
        <li>Estratificación de la columna de agua en algunos lugares: zonas superficiales oxigenadas y fondos anóxicos que favorecieron la conservación fósil.</li>
        <li>Los nutrientes (fosfatos, nitratos) en plataformas someras promovieron blooms de organismos y mayor productividad primaria.</li>
      </ul>

      <h3 style="margin-top:12px;">Fauna: grupos y ejemplos</h3>
      <p class="muted">Lista ampliada con descripciones cortas:</p>
      <ul>
        <li><strong>Trilobites</strong>: artrópodos con exoesqueleto calcáreo, gran diversidad y amplia distribución; útiles para bioestratigrafía.</li>
        <li><strong>Anomalocaris</strong>: gran depredador cambriano, con apéndices frontales y aparato bucal complejo; indicativo de redes tróficas más estructuradas.</li>
        <li><strong>Pikaia</strong>: uno de los primeros cordados probables; importante por su relación con la evolución de los vertebrados.</li>
        <li><strong>Hallucigenia</strong>: animal inusual con espinas dorsales; la interpretación anatómica fue re-evaluada tras hallazgos posteriores.</li>
        <li><strong>Opabinia</strong>: de morfología singular (cinco ojos), muestra la experimentación evolutiva del Cámbrico.</li>
        <li><strong>Braquiópodos, esponjas y briozoos</strong>: filtradores bentónicos comunes en comunidades someras.</li>
      </ul>

      <h3 style="margin-top:12px;">Flora y biota microbiana</h3>
      <ul>
        <li>Vegetación terrestre escasa o inexistente; algas eucariotas y biocapas microbianas dominaron los ecosistemas marinos superficiales.</li>
        <li>Los tapetes microbianos estabilizaron sedimentos y generaron microhábitats para invertebrados pequeños.</li>
      </ul>

      <h3 style="margin-top:12px;">Fósiles y yacimientos clave</h3>
      <ul>
        <li><strong>Burgess Shale</strong> (Canadá): conservación excepcional de tejidos blandos; proporciona ventanas únicas a la biodiversidad cambriana.</li>
        <li><strong>Chengjiang</strong> (China): otro yacimiento de conservación excepcional, con importantes implicaciones en la filogenia animal.</li>
        <li><strong>Small Shelly Fauna</strong>: organismos con conchas pequeñas y fragmentadas que marcan la aparición de estructuras mineralizadas.</li>
      </ul>

      <h3 style="margin-top:12px;">Métodos de estudio</h3>
      <ul>
        <li>Estratigrafía y datación radiométrica para fijar marcos temporales.</li>
        <li>Microscopía y tomografía para estudiar morfología interna de fósiles.</li>
        <li>Modelos paleoecológicos y simulaciones para reconstruir redes tróficas y circulación oceánica.</li>
      </ul>

      <h3 style="margin-top:12px;">Curiosidades y datos para tu exposición</h3>
      <ul>
        <li>La palabra "Cámbrico" proviene de "Cambria", nombre latino de Gales, lugar de estudios geológicos clásicos.</li>
        <li>Muchas formas del Cámbrico parecen "experimentales" — algunos filos modernos emergen, otros no perduraron.</li>
        <li>El estudio de estos fósiles ayuda a entender la evolución temprana de órganos sensoriales y sistemas locomotores.</li>
      </ul>
    </section>

    <!-- JUEGOS (realmente interactivos) -->
    <section class="panel" id="juegos">
      <h2 class="section-title">Zona de juegos — Interactivos del Cámbrico</h2>
      <p class="muted">Tres experiencias interactivas. > Pulsa EN INICIAR para empezar — ninguno arranca solo.</p>

      <div class="games">
        <!-- QUIZ AVANZADO -->
        <div class="game" id="game-quiz">
          <h3>Quiz avanzado</h3>
          <div id="quizArea"></div>
          <div class="game-controls">
            <button class="btn" id="startQuizBtn">Iniciar Quiz</button>
            <button class="btn secondary" id="checkQuizBtn">Comprobar</button>
            <div class="status" id="quizStatus">Estado: inactivo</div>
          </div>
          <p class="muted-small">El quiz está pensado para repasar los conceptos del Cámbrico.</p>
        </div>

        <!-- SUBMARINO -->
        <div class="game" id="game-submarine">
          <h3>Submarino Temporal</h3>
          <canvas id="submarineCanvas" width="640" height="320" aria-label="Submarino Temporal"></canvas>
          <div class="game-controls">
            <button class="btn" id="startSubBtn">Iniciar Submarino</button>
            <button class="btn secondary" id="stopSubBtn">Parar / Reiniciar</button>
            <div class="status">Puntuación: <strong id="subPoints">0</strong></div>
          </div>
          <p class="muted-small">Mueve el ratón dentro del canvas o toca para controlar. Recolecta fósiles cámbricos (verde) y evita elementos modernos (rojo).</p>
        </div>

        <!-- AVIÓN -->
        <div class="game" id="game-plane">
          <h3>Vuelo del Tiempo — Avión atrapapalabras</h3>
          <canvas id="planeCanvas" width="640" height="320" aria-label="Vuelo del Tiempo"></canvas>
          <div class="game-controls">
            <button class="btn" id="startPlaneBtn">Iniciar Vuelo</button>
            <button class="btn secondary" id="stopPlaneBtn">Parar / Reiniciar</button>
            <div class="status">Puntos: <strong id="planePoints">0</strong></div>
          </div>
          <p class="muted-small">Atrapa palabras correctas para la pregunta actual. Controla con el ratón o touch.</p>
        </div>
      </div>
    </section>

    <!-- RESERVAS con calendario interactivo entrada/salida -->
    <section class="panel" id="reservas">
      <h2 class="section-title">Reservas — Calendario interactivo</h2>
      <div style="display:flex; gap:18px; flex-wrap:wrap; align-items:flex-start;">
        <div class="calendar" id="calendarWidget"></div>

        <div style="flex:1; min-width:320px;">
          <div style="background:#fff; padding:12px; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.06);">
            <h3>Solicitud de reserva</h3>
            <p class="muted-small">Selecciona fecha de entrada y salida en el calendario. No se permiten fechas pasadas.</p>

            <div style="margin-top:8px;">
              <div class="muted-small">Entrada: <strong id="selStart">—</strong></div>
              <div class="muted-small">Salida: <strong id="selEnd">—</strong></div>
              <div class="muted-small">Duración: <strong id="selDays">—</strong> noches</div>
            </div>

            <form id="bookingForm" style="margin-top:12px;">
              <label class="muted-small">Nombre</label>
              <input id="bookName" placeholder="Tu nombre" required>
              <label class="muted-small">Email</label>
              <input id="bookEmail" type="email" placeholder="correo@ejemplo.com" required>
              <label class="muted-small">Teléfono</label>
              <input id="bookPhone" placeholder="+34 ...">
              <label class="muted-small">Comentarios</label>
              <textarea id="bookNotes" placeholder="Alergias, preferencias..."></textarea>
              <button class="btn" type="submit" style="margin-top:10px">Enviar reserva</button>
              <p id="bookingMsg" class="muted-small" style="margin-top:10px"></p>
            </form>

          </div>
        </div>
      </div>

      <p class="muted-small" style="margin-top:10px;">Nota: el sitio está creado para tu trabajo del instituto. El proceso de reserva está simulado y se presenta como si la agencia vendiera viajes al pasado (según las instrucciones del proyecto).</p>
    </section>

  </main>

  <footer>
    <div style="max-width:var(--maxw); margin:0 auto; padding:10px;">
      <strong>Cronoviajes S.A.</strong> — © <span id="year"></span> — Descubre el pasado, vive el origen
    </div>
  </footer>

  <!-- ===================================================
       SCRIPTS: slider + games + calendar + gallery + helpers
       =================================================== -->
  <script>
  // Small utilities
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  document.getElementById('year').textContent = new Date().getFullYear();

  // Scrolling helper for topnav
  function scrollToSection(id){
    const mapping = {
      'inicio': document.querySelector('.hero'),
      'galeria': document.getElementById('galeria'),
      'info': document.getElementById('info'),
      'juegos': document.getElementById('juegos'),
      'reservas': document.getElementById('reservas'),
    };
    const el = mapping[id] || document.getElementById(id);
    if(el) el.scrollIntoView({behavior:'smooth'});
  }

  /* ===================================================
     HERO SLIDER
     - 4 slides, cambia cada 3s
     - botón alternar contraste: añade clase .light en .hero
     =================================================== */
  (function HeroSlider(){
    const slider = document.getElementById('heroSlider');
    const slides = Array.from(slider.querySelectorAll('.slide'));
    let index = 0;
    const changeInterval = 3000;

    function show(i){
      slides.forEach((s,idx)=> s.classList.toggle('active', idx === i));
    }

    let timer = setInterval(()=>{
      index = (index + 1) % slides.length;
      show(index);
    }, changeInterval);

    // Pause on hover (desktop)
    slider.addEventListener('mouseenter', ()=> clearInterval(timer));
    slider.addEventListener('mouseleave', ()=> { timer = setInterval(()=>{ index = (index+1)%slides.length; show(index); }, changeInterval); });

    // contrast toggle
    const btnToggle = document.getElementById('btnToggleContrast');
    const hero = document.querySelector('.hero');
    btnToggle.addEventListener('click', ()=>{
      hero.classList.toggle('light');
      // adjust hero text color depending on overlay
      const isLight = hero.classList.contains('light');
      const elems = [ ...$$('.hero-title'), ...$$('.hero-sub'), ...$$('.logo') ];
      elems.forEach(el=>{
        el.style.color = isLight ? 'var(--hero-foreground-dark)' : 'var(--hero-foreground-light)';
      });
      // change topnav link colors
      $$('.topnav a').forEach(a => a.style.color = isLight ? 'var(--deep)' : 'rgba(255,255,255,0.95)');
      btnToggle.textContent = isLight ? 'Contraste: claro' : 'Alternar contraste';
    });

    // CTA reservation scroll
    $('#btnReserve').addEventListener('click', ()=> { scrollToSection('reservas'); });
    // slight logo float
    setInterval(()=> document.getElementById('logo').classList.toggle('float'), 1900);
  })();

  /* ===================================================
     GALLERY LIGHTBOX
     =================================================== */
  (function Gallery(){
    const grid = document.getElementById('galleryGrid');
    grid.addEventListener('click', (e) => {
      if(e.target && e.target.tagName === 'IMG'){
        const src = e.target.src;
        const alt = e.target.alt || '';
        const overlay = document.createElement('div');
        overlay.style.position = 'fixed'; overlay.style.inset = 0; overlay.style.background = 'rgba(0,0,0,0.88)';
        overlay.style.display = 'flex'; overlay.style.alignItems = 'center'; overlay.style.justifyContent = 'center';
        overlay.style.zIndex = 9999; overlay.style.cursor = 'zoom-out';
        const img = document.createElement('img');
        img.src = src; img.alt = alt; img.style.maxWidth = '94%'; img.style.maxHeight = '94%'; img.style.borderRadius = '8px';
        overlay.appendChild(img);
        overlay.addEventListener('click', ()=> overlay.remove());
        document.body.appendChild(overlay);
      }
    });
  })();

  /* ===================================================
     QUIZ AVANZADO
     =================================================== */
  (function Quiz(){
    const questions = [
      { q: "¿Hace cuántos millones de años comenzó el Cámbrico?", a: "541" },
      { q: "Nombre de un depredador ápice del Cámbrico", a: "anomalocaris" },
      { q: "Un cordado primitivo del Cámbrico", a: "pikaia" },
      { q: "Organismo con una trompa y cinco ojos", a: "opabinia" },
      { q: "Yacimiento con conservación de tejidos blandos en Canadá", a: "burgess" },
    ];
    let active = false;
    const area = document.getElementById('quizArea');
    const status = document.getElementById('quizStatus');

    function build(){
      area.innerHTML = '';
      questions.forEach((it, idx)=>{
        const div = document.createElement('div');
        div.style.marginBottom = '10px';
        div.innerHTML = `<strong>${idx+1}.</strong> ${it.q}<div style="margin-top:8px"><input id="qa${idx}" style="width:100%; padding:8px; border-radius:8px; border:1px solid #e1f6fb;"></div>`;
        area.appendChild(div);
      });
      status.textContent = 'Estado: activo';
      active = true;
    }

    $('#startQuizBtn').addEventListener('click', ()=> build());
    $('#checkQuizBtn').addEventListener('click', ()=>{
      if(!active){ status.textContent = 'Estado: inactivo (pulsa Iniciar Quiz)'; return; }
      let score = 0;
      questions.forEach((it,i)=>{
        const val = (document.getElementById('qa'+i)?.value || '').toLowerCase();
        if(it.a === 'burgess'){
          if(val.includes('burgess') || val.includes('burgess shale')) score++;
        } else if(it.a === '541'){
          if(val.includes('541') || val.includes('541')) score++;
        } else {
          if(val.includes(it.a)) score++;
        }
      });
      status.textContent = `Resultado: ${score} / ${questions.length}`;
      active = false;
    });
  })();

  /* ===================================================
     SUBMARINO — Canvas real
     - control mouse/touch
     - objetos: items[] with ok true/false
     =================================================== */
  (function Submarine(){
    const canvas = document.getElementById('submarineCanvas');
    const ctx = canvas.getContext('2d');
    let dpr = window.devicePixelRatio || 1;
    function resize(){
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener('resize', ()=> { dpr = window.devicePixelRatio || 1; resize(); });

    // state
    let state = {
      running:false, player:{x:60, y:140, w:60, h:28}, items:[], tick:0, score:0, spawnRate:60, mouseY:undefined
    };

    function spawn(){
      // mix of cámbrico items (ok) and 'moderno' items (no)
      const pool = [
        {label:'trilobite', ok:true},
        {label:'anomalocaris', ok:true},
        {label:'pikaia', ok:true},
        {label:'opabinia', ok:true},
        {label:'alga', ok:true},
        {label:'tornillo', ok:false},
        {label:'teléfono', ok:false},
        {label:'carro', ok:false}
      ];
      const pick = pool[Math.floor(Math.random()*pool.length)];
      state.items.push({
        x: 760, y: 20 + Math.random()*260,
        vx: -1.6 - Math.random()*1.8, label: pick.label, ok: pick.ok,
        size: 12 + Math.random()*14
      });
    }

    function drawBackground(){
      // gradient water
      const g = ctx.createLinearGradient(0,0,0,320);
      g.addColorStop(0,'#e6fbff');
      g.addColorStop(1,'#d9f3ff');
      ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width/dpr, canvas.height/dpr);
      // seabed
      ctx.fillStyle = '#cfeef8';
      ctx.fillRect(0, 300, canvas.width/dpr, 20);
    }

    function draw(){
      if(!state.running) return;
      state.tick++;
      if(state.tick % state.spawnRate === 0) spawn();

      // clear
      ctx.clearRect(0,0,canvas.width/dpr, canvas.height/dpr);
      drawBackground();

      // player
      const p = state.player;
      ctx.fillStyle = '#005f7f';
      ctx.fillRect(p.x, p.y, p.w, p.h);
      ctx.fillStyle = '#00b4d8';
      ctx.fillRect(p.x+8, p.y+6, p.w-16, p.h-12);

      // items
      for(let i=state.items.length-1;i>=0;i--){
        const it = state.items[i];
        it.x += it.vx;
        ctx.fillStyle = it.ok ? 'rgba(42,157,143,0.95)' : 'rgba(214,40,40,0.95)';
        ctx.beginPath(); ctx.arc(it.x, it.y, it.size, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = '#fff'; ctx.font = '12px Poppins'; ctx.fillText(it.label, it.x - it.size, it.y - it.size - 6);

        // collision check simple box
        if(it.x < p.x + p.w && it.x > p.x && it.y > p.y && it.y < p.y + p.h){
          if(it.ok) state.score += 10; else state.score = Math.max(0, state.score - 5);
          state.items.splice(i,1);
          document.getElementById('subPoints').textContent = state.score;
        } else if(it.x < -40) state.items.splice(i,1);
      }

      // follow mouseY
      if(state.mouseY !== undefined){
        p.y += (state.mouseY - p.y - p.h/2) * 0.12;
        if(p.y < 6) p.y = 6;
        if(p.y > 300 - p.h - 6) p.y = 300 - p.h - 6;
      }

      // HUD / instructions
      ctx.fillStyle = '#003a55'; ctx.font = '13px Poppins'; ctx.fillText('Recolecta fósiles cámbricos (verde). Evita objetos modernos (rojo).', 12, 16);

      requestAnimationFrame(draw);
    }

    // events
    canvas.addEventListener('mousemove', (e)=> {
      const r = canvas.getBoundingClientRect();
      state.mouseY = e.clientY - r.top;
    });
    canvas.addEventListener('touchmove', (e)=> {
      const r = canvas.getBoundingClientRect();
      if(e.touches && e.touches[0]) state.mouseY = e.touches[0].clientY - r.top;
      e.preventDefault();
    }, { passive:false });

    // controls
    $('#startSubBtn').addEventListener('click', ()=>{
      resize(); state.running = true; state.tick = 0; state.items = []; state.score = 0; $('#subPoints').textContent = 0; draw();
    });
    $('#stopSubBtn').addEventListener('click', ()=>{
      state.running = false; // reset visuals
      state = { running:false, player:{x:60, y:140, w:60, h:28}, items:[], tick:0, score:0, spawnRate:60, mouseY:undefined };
      ctx.clearRect(0,0,canvas.width/dpr, canvas.height/dpr);
      drawBackground();
      ctx.fillStyle = '#003a55'; ctx.font='14px Poppins'; ctx.fillText('Pulsa Iniciar Submarino para comenzar.', 12, 22);
      $('#subPoints').textContent = 0;
    });

    // initial draw
    (function init(){
      resize();
      drawBackground();
      ctx.fillStyle = '#003a55'; ctx.font='14px Poppins'; ctx.fillText('Pulsa Iniciar Submarino para comenzar.', 12, 22);
    })();

  })();

  /* ===================================================
     PLANE GAME - Vuelo del tiempo (canvas)
     - spawnea palabras que caen
     - el avión recoge palabras correctas según pregunta actual
     =================================================== */
  (function PlaneGame(){
    const canvas = document.getElementById('planeCanvas');
    const ctx = canvas.getContext('2d');
    let dpr = window.devicePixelRatio || 1;
    function resize(){
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener('resize', ()=> { dpr = window.devicePixelRatio || 1; resize(); });

    // state
    let state = { running:false, player:{x:320, y:260, w:44, h:20}, words:[], tick:0, score:0, mouseX:undefined, currentQ:null };

    const questions = [
      { q: "Depredador del Cámbrico", correct: ["anomalocaris","opabinia"] },
      { q: "Cordado primitivo", correct: ["pikaia"] },
      { q: "Elemento típico (esqueleto)", correct: ["trilobite","braquiópodo","small shelly"] },
      { q: "Organismo con cinco ojos", correct: ["opabinia"] }
    ];

    const pool = ['trilobite','anomalocaris','pikaia','dinosaurio','alga','opabinia','braquiópodo','fósil','cámbrico','vida','pez','estrella','teléfono','coche'];

    function spawnWord(){
      const w = pool[Math.floor(Math.random()*pool.length)];
      state.words.push({ x: 30 + Math.random()*(canvas.width/dpr - 60), y: -20, vy: 1 + Math.random()*1.8, text: w });
    }

    function drawBackground(){
      const g = ctx.createLinearGradient(0,0,0,320); g.addColorStop(0,'#fff7f0'); g.addColorStop(1,'#e8f7ff');
      ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width/dpr, canvas.height/dpr);
    }

    function loop(){
      if(!state.running) return;
      state.tick++;
      if(state.tick % 55 === 0) spawnWord();

      ctx.clearRect(0,0,canvas.width/dpr, canvas.height/dpr);
      drawBackground();

      // question
      ctx.fillStyle = '#003a55'; ctx.font = '16px Poppins';
      ctx.fillText('Pregunta: ' + (state.currentQ?.q || '—'), 10, 20);

      // plane drawing
      const pl = state.player;
      ctx.fillStyle = '#0077b6';
      ctx.beginPath(); ctx.moveTo(pl.x, pl.y); ctx.lineTo(pl.x-22, pl.y+16); ctx.lineTo(pl.x+22, pl.y+16); ctx.closePath(); ctx.fill();

      // words
      for(let i=state.words.length-1;i>=0;i--){
        const it = state.words[i]; it.y += it.vy;
        ctx.fillStyle = '#ffd166';
        ctx.font = '13px Poppins';
        const tw = ctx.measureText(it.text).width + 14;
        const rx = it.x - tw/2;
        ctx.fillRect(rx, it.y - 14, tw, 22);
        ctx.fillStyle = '#00303a';
        ctx.fillText(it.text, rx + 7, it.y + 4);

        // collision with plane
        if(it.y > pl.y - 10 && it.y < pl.y + 18 && Math.abs(it.x - pl.x) < 30){
          const correctList = state.currentQ?.correct || [];
          if(correctList.some(k => it.text.includes(k))) {
            state.score += 10;
            // new question
            state.currentQ = questions[Math.floor(Math.random()*questions.length)];
          } else {
            state.score = Math.max(0, state.score - 5);
          }
          state.words.splice(i,1);
          document.getElementById('planePoints').textContent = state.score;
        } else if(it.y > canvas.height/dpr + 20) state.words.splice(i,1);
      }

      // plane movement
      if(state.mouseX !== undefined){
        pl.x += (state.mouseX - pl.x) * 0.12;
        if(pl.x < 22) pl.x = 22;
        if(pl.x > (canvas.width/dpr)-22) pl.x = (canvas.width/dpr)-22;
      }

      requestAnimationFrame(loop);
    }

    // events
    canvas.addEventListener('mousemove', (e)=> {
      const r = canvas.getBoundingClientRect(); state.mouseX = e.clientX - r.left;
    });
    canvas.addEventListener('touchmove', (e)=> {
      const r = canvas.getBoundingClientRect();
      if(e.touches && e.touches[0]) state.mouseX = e.touches[0].clientX - r.left;
      e.preventDefault();
    }, { passive:false });

    // controls
    $('#startPlaneBtn').addEventListener('click', ()=>{
      resize(); state.running = true; state.score = 0; state.tick = 0; state.words = []; state.currentQ = questions[Math.floor(Math.random()*questions.length)];
      $('#planePoints').textContent = 0; loop();
    });
    $('#stopPlaneBtn').addEventListener('click', ()=>{
      state.running = false; state = { running:false, player:{x:320,y:260,w:44,h:20}, words:[], tick:0, score:0, mouseX:undefined, currentQ:null };
      ctx.clearRect(0,0,canvas.width/dpr,canvas.height/dpr);
      drawBackground();
      ctx.fillStyle = '#003a55'; ctx.font='14px Poppins'; ctx.fillText('Pulsa Iniciar Vuelo para comenzar.', 12, 22);
      $('#planePoints').textContent = 0;
    });

    function resize(){
      const rect = canvas.getBoundingClientRect();
      dpr = window.devicePixelRatio || 1;
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }

    // initial draw
    (function init(){
      resize();
      drawBackground();
      ctx.fillStyle = '#003a55'; ctx.font='14px Poppins'; ctx.fillText('Pulsa Iniciar Vuelo para comenzar.', 12, 22);
    })();

  })();

  /* ===================================================
     CALENDARIO INTERACTIVO (entrada/salida)
     - pura JS, sin librerías
     =================================================== */
  (function Calendar(){
    const container = document.getElementById('calendarWidget');
    let selectedStart = null, selectedEnd = null;
    const today = new Date(); today.setHours(0,0,0,0);
    let viewYear = today.getFullYear(), viewMonth = today.getMonth();

    function build(){
      container.innerHTML = '';
      const cal = document.createElement('div');

      // header
      const monthRow = document.createElement('div'); monthRow.className = 'month';
      const monthNames = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
      const title = document.createElement('div'); title.textContent = `${monthNames[viewMonth]} ${viewYear}`; title.style.fontWeight = '800';
      const prev = document.createElement('button'); prev.textContent = '◀'; prev.className='btn secondary'; prev.style.padding='6px 10px';
      const next = document.createElement('button'); next.textContent = '▶'; next.className='btn secondary'; next.style.padding='6px 10px';
      prev.onclick = ()=> { if(viewMonth === 0){ viewMonth=11; viewYear--; } else viewMonth--; renderGrid(); };
      next.onclick = ()=> { if(viewMonth === 11){ viewMonth=0; viewYear++; } else viewMonth++; renderGrid(); };

      const left = document.createElement('div'); left.appendChild(prev); left.appendChild(title);
      const right = document.createElement('div'); right.appendChild(next);
      monthRow.appendChild(left); monthRow.appendChild(right);
      cal.appendChild(monthRow);

      // weekdays
      const weekdays = document.createElement('div'); weekdays.className = 'weekdays';
      ['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'].forEach(d=>{ const el = document.createElement('div'); el.className='weekday'; el.textContent = d; el.style.fontWeight='700'; weekdays.appendChild(el); });
      cal.appendChild(weekdays);

      // days
      const days = document.createElement('div'); days.className = 'days'; days.style.marginTop = '8px';
      cal.appendChild(days);

      container.appendChild(cal);

      function renderGrid(){
        days.innerHTML = '';
        const first = new Date(viewYear, viewMonth, 1);
        const last = new Date(viewYear, viewMonth+1, 0);
        const firstWeekday = (first.getDay() + 6) % 7; // 0=Mon..6=Sun
        for(let i=0;i<firstWeekday;i++){ const e = document.createElement('div'); e.className='weekday'; days.appendChild(e); }
        for(let d=1; d<=last.getDate(); d++){
          const dt = new Date(viewYear, viewMonth, d); dt.setHours(0,0,0,0);
          const el = document.createElement('div'); el.className='day box'; el.textContent = d;
          if(dt < today){ el.classList.add('disabled'); }
          else { el.addEventListener('click', ()=> onDateClick(dt)); }
          if(selectedStart && sameDay(dt, selectedStart)) el.classList.add('selected');
          else if(selectedEnd && sameDay(dt, selectedEnd)) el.classList.add('selected');
          else if(selectedStart && selectedEnd && dt > selectedStart && dt < selectedEnd) el.classList.add('inrange');
          days.appendChild(el);
        }
      }
      renderGrid();
    }

    function onDateClick(dt){
      if(!selectedStart || (selectedStart && selectedEnd)){ selectedStart = dt; selectedEnd = null; }
      else { if(dt < selectedStart){ selectedStart = dt; selectedEnd = null; } else selectedEnd = dt; }
      updateSummary(); build();
    }
    function sameDay(a,b){ return a && b && a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }
    function formatDate(d){ if(!d) return '—'; return d.toLocaleDateString('es-ES', {day:'2-digit', month:'short', year:'numeric'}); }
    function updateSummary(){
      $('#selStart').textContent = selectedStart ? formatDate(selectedStart) : '—';
      $('#selEnd').textContent = selectedEnd ? formatDate(selectedEnd) : '—';
      if(selectedStart && selectedEnd){ const days = Math.round((selectedEnd - selectedStart)/(1000*60*60*24)); $('#selDays').textContent = days; } else $('#selDays').textContent = '—';
    }

    window.CronoviajesCalendar = {
      init: ()=> build(),
      getSelection: ()=> ({ start:selectedStart, end:selectedEnd, days: selectedStart && selectedEnd ? Math.round((selectedEnd-selectedStart)/(1000*60*60*24)) : null }),
      setSelection: (s,e)=>{ selectedStart = s; selectedEnd = e; build(); updateSummary(); }
    };

    build();
    updateSummary();

  })();

  // Mini reservation: update on booking form submit
  (function BookingForm(){
    $('#bookingForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const sel = window.CronoviajesCalendar?.getSelection();
      if(!sel || !sel.start || !sel.end){ $('#bookingMsg').textContent = 'Selecciona entrada y salida en el calendario.'; return; }
      const name = $('#bookName').value || 'Cliente';
      const email = $('#bookEmail').value || '—';
      const phone = $('#bookPhone').value || '—';
      $('#bookingMsg').textContent = `Gracias ${name}. Su reserva provisional del ${sel.start.toLocaleDateString()} al ${sel.end.toLocaleDateString()} ha sido registrada (simulada). Confirmaremos por ${email} / ${phone}.`;
    });
  })();

  /* ===================================================
     Accessibility: shortcuts to start games
     =================================================== */
  window.addEventListener('keydown', (e)=>{
    if(e.key === '1') $('#startQuizBtn').click();
    if(e.key === '2') $('#startSubBtn').click();
    if(e.key === '3') $('#startPlaneBtn').click();
  });

  // Improve canvas crispness on load/resize
  window.addEventListener('load', ()=> {
    // trigger calendar init
    if(window.CronoviajesCalendar) window.CronoviajesCalendar.init();
    // small extra: hide images with onerror removed - handled by onerror attr in HTML
  });
  </script>

  <!-- ===================================================
       INSTRUCCIONES (no son parte del HTML visual)
       ===================================================
       Cómo añadir tus fotos (resumen rápido):

       1) Localmente:
          - En la misma carpeta donde guardes este index.html, crea una carpeta llamada "images".
          - Pon tus fotos dentro: e.g.
            images/trilobite.jpg
            images/anomalocaris.jpg
            images/opabinia.jpg
            images/hallucigenia.jpg
          - En el HTML, en la GALERÍA (ID: galleryGrid) las rutas ya apuntan a images/*.jpg.
            Si tus nombres son diferentes, edítalos.

       2) En GitHub:
          - Crea un repositorio nuevo (por ejemplo "cronoviajes").
          - Sube index.html a la raíz, y sube la carpeta images/ con tus fotos.
            (En GitHub web: "Add file" -> "Upload files" o usa git local).
          - En Settings -> Pages selecciona Branch: main (o la rama que uses) / root (/) y guarda.
            La página se publicará en https://TU_USUARIO.github.io/TU_REPO/ (tarda unos minutos).

       3) Usar enlaces externos:
          - Si no quieres subir fotos, sustituye el src en <img src="..."> por un enlace directo (p.ej. de Pexels o Unsplash).
            Ejemplo:
            <img src="https://images.pexels.com/photos/1103569/pexels-photo-1103569.jpeg" alt="...">

       Recomendaciones:
         - Optimiza las imágenes (herramientas como Squoosh o TinyPNG) antes de subir (reduce tamaño y peso).
         - Nombres sin espacios y en minúsculas (p.ej. trilobite.jpg).
         - En Github Pages, si la imagen no aparece, revisa mayúsculas/minúsculas (Linux distingue).
  -->
</body>
</html>


